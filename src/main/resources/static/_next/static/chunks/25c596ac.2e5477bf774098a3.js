"use strict";(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[98],{3018:function(e,t,i){i.d(t,{uK:function(){return U}});var r=i(655),n=i(6147),a=i(3782),o=i(7442),l=i(5222),u=i(3887),s=i(1628),c=i(766),h=i(530),b=i(9672),f=i(4891),d=i(3269),p=i(7943);function v(e,t,i){if(t<i)throw Error("Required at least "+i+" arguments for "+e+" but got "+t)}function g(e,t,i){if(v(e,t,i),t%i!=0)throw Error("Arguments for "+e+" must be in pairs of "+i)}function y(e){if(0===e||1===e)return e;throw Error("Flag must be 0 or 1")}function w(e,t){for(;!e.interactive||t(e);)if(e._parent)e=e._parent;else break}function m(e,t,i){return c.Oo(e,c.FL(t),function(e){var t=e.touches;t?(0==t.length&&(t=e.changedTouches),i(h.JG(t))):i([e])})}function _(e){var t=document.createElement("canvas");t.width=1,t.height=1;var i=t.getContext("2d",{willReadFrequently:!0});i.drawImage(e,0,0,1,1);try{return i.getImageData(0,0,1,1),!1}catch(r){return console.warn('Image "'+e.src+'" is loaded from different host and is not covered by CORS policy. For more information about the implications read here: https://www.amcharts.com/docs/v5/concepts/cors'),!0}}function x(e){e.width=0,e.height=0,e.style.width="0px",e.style.height="0px"}var O=function(){function e(){Object.defineProperty(this,"_x",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(this,"_y",{enumerable:!0,configurable:!0,writable:!0,value:0})}return Object.defineProperty(e.prototype,"x",{get:function(){return this._x},set:function(e){this._x=e},enumerable:!1,configurable:!0}),Object.defineProperty(e.prototype,"y",{get:function(){return this._y},set:function(e){this._y=e},enumerable:!1,configurable:!0}),e}(),P=function(e){function t(t){var i=e.call(this)||this;return Object.defineProperty(i,"_layer",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(i,"mask",{enumerable:!0,configurable:!0,writable:!0,value:null}),Object.defineProperty(i,"visible",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(i,"exportable",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(i,"interactive",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(i,"inactive",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(i,"wheelable",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(i,"cancelTouch",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(i,"isMeasured",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(i,"buttonMode",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(i,"alpha",{enumerable:!0,configurable:!0,writable:!0,value:1}),Object.defineProperty(i,"compoundAlpha",{enumerable:!0,configurable:!0,writable:!0,value:1}),Object.defineProperty(i,"angle",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(i,"scale",{enumerable:!0,configurable:!0,writable:!0,value:1}),Object.defineProperty(i,"x",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(i,"y",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(i,"pivot",{enumerable:!0,configurable:!0,writable:!0,value:new O}),Object.defineProperty(i,"filter",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(i,"cursorOverStyle",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(i,"_replacedCursorStyle",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(i,"_localMatrix",{enumerable:!0,configurable:!0,writable:!0,value:new o.y}),Object.defineProperty(i,"_matrix",{enumerable:!0,configurable:!0,writable:!0,value:new o.y}),Object.defineProperty(i,"_uMatrix",{enumerable:!0,configurable:!0,writable:!0,value:new o.y}),Object.defineProperty(i,"_renderer",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(i,"_parent",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(i,"_localBounds",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(i,"_bounds",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(i,"_colorId",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),i._renderer=t,i}return(0,r.ZT)(t,e),Object.defineProperty(t.prototype,"_dispose",{enumerable:!1,configurable:!0,writable:!0,value:function(){this._renderer._removeObject(this)}}),Object.defineProperty(t.prototype,"getCanvas",{enumerable:!1,configurable:!0,writable:!0,value:function(){return this.getLayer().view}}),Object.defineProperty(t.prototype,"getLayer",{enumerable:!1,configurable:!0,writable:!0,value:function(){for(var e=this;;){if(e._layer)return e._layer;if(!e._parent)return this._renderer.defaultLayer;e=e._parent}}}),Object.defineProperty(t.prototype,"setLayer",{enumerable:!1,configurable:!0,writable:!0,value:function(e,t){void 0===t&&(t=!0),null==e?this._layer=void 0:(this._layer=this._renderer.getLayer(e,t),this._layer.visible=t,this._parent&&this._parent.registerChildLayer(this._layer))}}),Object.defineProperty(t.prototype,"markDirtyLayer",{enumerable:!1,configurable:!0,writable:!0,value:function(){this.getLayer().dirty=!0}}),Object.defineProperty(t.prototype,"clear",{enumerable:!1,configurable:!0,writable:!0,value:function(){this.invalidateBounds()}}),Object.defineProperty(t.prototype,"invalidateBounds",{enumerable:!1,configurable:!0,writable:!0,value:function(){this._localBounds=void 0}}),Object.defineProperty(t.prototype,"_addBounds",{enumerable:!1,configurable:!0,writable:!0,value:function(e){}}),Object.defineProperty(t.prototype,"_getColorId",{enumerable:!1,configurable:!0,writable:!0,value:function(){return void 0===this._colorId&&(this._colorId=this._renderer.paintId(this)),this._colorId}}),Object.defineProperty(t.prototype,"_isInteractive",{enumerable:!1,configurable:!0,writable:!0,value:function(){return!1==this.inactive&&(this.interactive||this._renderer._forceInteractive>0)}}),Object.defineProperty(t.prototype,"_isInteractiveMask",{enumerable:!1,configurable:!0,writable:!0,value:function(){return this._isInteractive()}}),Object.defineProperty(t.prototype,"contains",{enumerable:!1,configurable:!0,writable:!0,value:function(e){for(;;){if(e===this)return!0;if(!e._parent)return!1;e=e._parent}}}),Object.defineProperty(t.prototype,"toGlobal",{enumerable:!1,configurable:!0,writable:!0,value:function(e){return this._matrix.apply(e)}}),Object.defineProperty(t.prototype,"toLocal",{enumerable:!1,configurable:!0,writable:!0,value:function(e){return this._matrix.applyInverse(e)}}),Object.defineProperty(t.prototype,"getLocalMatrix",{enumerable:!1,configurable:!0,writable:!0,value:function(){return this._uMatrix.setTransform(0,0,this.pivot.x,this.pivot.y,this.angle*Math.PI/180,this.scale),this._uMatrix}}),Object.defineProperty(t.prototype,"getLocalBounds",{enumerable:!1,configurable:!0,writable:!0,value:function(){return this._localBounds||(this._localBounds={left:1e7,top:1e7,right:-1e7,bottom:-1e7},this._addBounds(this._localBounds)),this._localBounds}}),Object.defineProperty(t.prototype,"getAdjustedBounds",{enumerable:!1,configurable:!0,writable:!0,value:function(e){this._setMatrix();var t=this.getLocalMatrix(),i=t.apply({x:e.left,y:e.top}),r=t.apply({x:e.right,y:e.top}),n=t.apply({x:e.right,y:e.bottom}),a=t.apply({x:e.left,y:e.bottom});return{left:Math.min(i.x,r.x,n.x,a.x),top:Math.min(i.y,r.y,n.y,a.y),right:Math.max(i.x,r.x,n.x,a.x),bottom:Math.max(i.y,r.y,n.y,a.y)}}}),Object.defineProperty(t.prototype,"on",{enumerable:!1,configurable:!0,writable:!0,value:function(e,t,i){return this.interactive?this._renderer._addEvent(this,e,t,i):new u.ku(function(){})}}),Object.defineProperty(t.prototype,"_setMatrix",{enumerable:!1,configurable:!0,writable:!0,value:function(){this._localMatrix.setTransform(this.x,this.y,this.pivot.x,this.pivot.y,this.angle*Math.PI/180,this.scale),this._matrix.copyFrom(this._localMatrix),this._parent&&this._matrix.prepend(this._parent._matrix)}}),Object.defineProperty(t.prototype,"_transform",{enumerable:!1,configurable:!0,writable:!0,value:function(e,t){var i=this._matrix;e.setTransform(i.a*t,i.b*t,i.c*t,i.d*t,i.tx*t,i.ty*t)}}),Object.defineProperty(t.prototype,"render",{enumerable:!1,configurable:!0,writable:!0,value:function(e){var t=this;if(this.visible&&(!1!==this.exportable||!this._renderer._omitTainted)){this._setMatrix();var i=this._renderer.resolution,r=this._renderer.layers,n=this._renderer._ghostContext,a=this.mask;a&&a._setMatrix(),h.S6(r,function(e){if(e){var r=e.context;r.save(),a&&(a._transform(r,e.scale||i),a._runPath(r),r.clip()),r.globalAlpha=t.compoundAlpha*t.alpha,t._transform(r,e.scale||i),t.filter&&(r.filter=t.filter)}}),n.save(),a&&this._isInteractiveMask()&&(a._transform(n,i),a._runPath(n),n.clip()),this._transform(n,i),this._render(e),n.restore(),h.S6(r,function(e){e&&e.context.restore()})}}}),Object.defineProperty(t.prototype,"_render",{enumerable:!1,configurable:!0,writable:!0,value:function(e){!1===this.exportable&&((this._layer||e).tainted=!0)}}),Object.defineProperty(t.prototype,"hovering",{enumerable:!1,configurable:!0,writable:!0,value:function(){return this._renderer._hovering.has(this)}}),Object.defineProperty(t.prototype,"dragging",{enumerable:!1,configurable:!0,writable:!0,value:function(){var e=this;return this._renderer._dragging.some(function(t){return t.value===e})}}),Object.defineProperty(t.prototype,"dispose",{enumerable:!1,configurable:!0,writable:!0,value:function(){this.getLayer().dirty=!0}}),Object.defineProperty(t.prototype,"shouldCancelTouch",{enumerable:!1,configurable:!0,writable:!0,value:function(){var e=this._renderer;return(!e.tapToActivate||!!e._touchActive)&&(!!this.cancelTouch||!!this._parent&&this._parent.shouldCancelTouch())}}),t}(u.KK),j=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return Object.defineProperty(t,"interactiveChildren",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(t,"_childLayers",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(t,"_children",{enumerable:!0,configurable:!0,writable:!0,value:[]}),t}return(0,r.ZT)(t,e),Object.defineProperty(t.prototype,"_isInteractiveMask",{enumerable:!1,configurable:!0,writable:!0,value:function(){return this.interactiveChildren||e.prototype._isInteractiveMask.call(this)}}),Object.defineProperty(t.prototype,"addChild",{enumerable:!1,configurable:!0,writable:!0,value:function(e){e._parent=this,this._children.push(e),e._layer&&this.registerChildLayer(e._layer)}}),Object.defineProperty(t.prototype,"addChildAt",{enumerable:!1,configurable:!0,writable:!0,value:function(e,t){e._parent=this,this._children.splice(t,0,e),e._layer&&this.registerChildLayer(e._layer)}}),Object.defineProperty(t.prototype,"removeChild",{enumerable:!1,configurable:!0,writable:!0,value:function(e){e._parent=void 0,h.Dm(this._children,e)}}),Object.defineProperty(t.prototype,"_render",{enumerable:!1,configurable:!0,writable:!0,value:function(t){var i=this;e.prototype._render.call(this,t);var r=this._renderer;this.interactive&&this.interactiveChildren&&++r._forceInteractive;var n=this._layer||t;h.S6(this._children,function(e){e.compoundAlpha=i.compoundAlpha*i.alpha,e.render(n)}),this.interactive&&this.interactiveChildren&&--r._forceInteractive}}),Object.defineProperty(t.prototype,"registerChildLayer",{enumerable:!1,configurable:!0,writable:!0,value:function(e){this._childLayers||(this._childLayers=[]),h.nm(this._childLayers,e),this._parent&&this._parent.registerChildLayer(e)}}),Object.defineProperty(t.prototype,"markDirtyLayer",{enumerable:!1,configurable:!0,writable:!0,value:function(t){void 0===t&&(t=!1),e.prototype.markDirtyLayer.call(this),t&&this._childLayers&&h.S6(this._childLayers,function(e){return e.dirty=!0})}}),Object.defineProperty(t.prototype,"dispose",{enumerable:!1,configurable:!0,writable:!0,value:function(){e.prototype.dispose.call(this),this._childLayers&&h.S6(this._childLayers,function(e){e.dirty=!0})}}),t}(P);function B(e,t){e.left=Math.min(e.left,t.x),e.top=Math.min(e.top,t.y),e.right=Math.max(e.right,t.x),e.bottom=Math.max(e.bottom,t.y)}var S=function(){function e(){}return Object.defineProperty(e.prototype,"colorize",{enumerable:!1,configurable:!0,writable:!0,value:function(e,t){}}),Object.defineProperty(e.prototype,"path",{enumerable:!1,configurable:!0,writable:!0,value:function(e){}}),Object.defineProperty(e.prototype,"addBounds",{enumerable:!1,configurable:!0,writable:!0,value:function(e){}}),e}(),C=function(e){function t(t){var i=e.call(this)||this;return Object.defineProperty(i,"color",{enumerable:!0,configurable:!0,writable:!0,value:t}),i}return(0,r.ZT)(t,e),Object.defineProperty(t.prototype,"colorize",{enumerable:!1,configurable:!0,writable:!0,value:function(e,t){void 0!==t?e.fillStyle=t:e.fillStyle=this.color}}),t}(S),T=function(e){function t(t){var i=e.call(this)||this;return Object.defineProperty(i,"clearShadow",{enumerable:!0,configurable:!0,writable:!0,value:t}),i}return(0,r.ZT)(t,e),Object.defineProperty(t.prototype,"colorize",{enumerable:!1,configurable:!0,writable:!0,value:function(e,t){e.fill(),this.clearShadow&&(e.shadowColor="",e.shadowBlur=0,e.shadowOffsetX=0,e.shadowOffsetY=0)}}),t}(S),k=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,r.ZT)(t,e),Object.defineProperty(t.prototype,"colorize",{enumerable:!1,configurable:!0,writable:!0,value:function(e,t){e.stroke()}}),t}(S),A=function(e){function t(t,i,r){var n=e.call(this)||this;return Object.defineProperty(n,"width",{enumerable:!0,configurable:!0,writable:!0,value:t}),Object.defineProperty(n,"color",{enumerable:!0,configurable:!0,writable:!0,value:i}),Object.defineProperty(n,"lineJoin",{enumerable:!0,configurable:!0,writable:!0,value:r}),n}return(0,r.ZT)(t,e),Object.defineProperty(t.prototype,"colorize",{enumerable:!1,configurable:!0,writable:!0,value:function(e,t){void 0!==t?e.strokeStyle=t:e.strokeStyle=this.color,e.lineWidth=this.width,this.lineJoin&&(e.lineJoin=this.lineJoin)}}),t}(S),E=function(e){function t(t){var i=e.call(this)||this;return Object.defineProperty(i,"dash",{enumerable:!0,configurable:!0,writable:!0,value:t}),i}return(0,r.ZT)(t,e),Object.defineProperty(t.prototype,"colorize",{enumerable:!1,configurable:!0,writable:!0,value:function(e,t){e.setLineDash(this.dash)}}),t}(S),M=function(e){function t(t){var i=e.call(this)||this;return Object.defineProperty(i,"dashOffset",{enumerable:!0,configurable:!0,writable:!0,value:t}),i}return(0,r.ZT)(t,e),Object.defineProperty(t.prototype,"colorize",{enumerable:!1,configurable:!0,writable:!0,value:function(e,t){e.lineDashOffset=this.dashOffset}}),t}(S),L=function(e){function t(t,i,r,n){var a=e.call(this)||this;return Object.defineProperty(a,"x",{enumerable:!0,configurable:!0,writable:!0,value:t}),Object.defineProperty(a,"y",{enumerable:!0,configurable:!0,writable:!0,value:i}),Object.defineProperty(a,"width",{enumerable:!0,configurable:!0,writable:!0,value:r}),Object.defineProperty(a,"height",{enumerable:!0,configurable:!0,writable:!0,value:n}),a}return(0,r.ZT)(t,e),Object.defineProperty(t.prototype,"path",{enumerable:!1,configurable:!0,writable:!0,value:function(e){e.rect(this.x,this.y,this.width,this.height)}}),Object.defineProperty(t.prototype,"addBounds",{enumerable:!1,configurable:!0,writable:!0,value:function(e){var t=this.x,i=this.y,r=t+this.width,n=i+this.height;B(e,{x:t,y:i}),B(e,{x:r,y:i}),B(e,{x:t,y:n}),B(e,{x:r,y:n})}}),t}(S),I=function(e){function t(t,i,r){var n=e.call(this)||this;return Object.defineProperty(n,"x",{enumerable:!0,configurable:!0,writable:!0,value:t}),Object.defineProperty(n,"y",{enumerable:!0,configurable:!0,writable:!0,value:i}),Object.defineProperty(n,"radius",{enumerable:!0,configurable:!0,writable:!0,value:r}),n}return(0,r.ZT)(t,e),Object.defineProperty(t.prototype,"path",{enumerable:!1,configurable:!0,writable:!0,value:function(e){e.moveTo(this.x+this.radius,this.y),e.arc(this.x,this.y,this.radius,0,2*Math.PI)}}),Object.defineProperty(t.prototype,"addBounds",{enumerable:!1,configurable:!0,writable:!0,value:function(e){B(e,{x:this.x-this.radius,y:this.y-this.radius}),B(e,{x:this.x+this.radius,y:this.y+this.radius})}}),t}(S),D=function(e){function t(t,i,r,n){var a=e.call(this)||this;return Object.defineProperty(a,"x",{enumerable:!0,configurable:!0,writable:!0,value:t}),Object.defineProperty(a,"y",{enumerable:!0,configurable:!0,writable:!0,value:i}),Object.defineProperty(a,"radiusX",{enumerable:!0,configurable:!0,writable:!0,value:r}),Object.defineProperty(a,"radiusY",{enumerable:!0,configurable:!0,writable:!0,value:n}),a}return(0,r.ZT)(t,e),Object.defineProperty(t.prototype,"path",{enumerable:!1,configurable:!0,writable:!0,value:function(e){e.ellipse(0,0,this.radiusX,this.radiusY,0,0,2*Math.PI)}}),Object.defineProperty(t.prototype,"addBounds",{enumerable:!1,configurable:!0,writable:!0,value:function(e){B(e,{x:this.x-this.radiusX,y:this.y-this.radiusY}),B(e,{x:this.x+this.radiusX,y:this.y+this.radiusY})}}),t}(S),Y=function(e){function t(t,i,r,n,a,o){var l=e.call(this)||this;return Object.defineProperty(l,"cx",{enumerable:!0,configurable:!0,writable:!0,value:t}),Object.defineProperty(l,"cy",{enumerable:!0,configurable:!0,writable:!0,value:i}),Object.defineProperty(l,"radius",{enumerable:!0,configurable:!0,writable:!0,value:r}),Object.defineProperty(l,"startAngle",{enumerable:!0,configurable:!0,writable:!0,value:n}),Object.defineProperty(l,"endAngle",{enumerable:!0,configurable:!0,writable:!0,value:a}),Object.defineProperty(l,"anticlockwise",{enumerable:!0,configurable:!0,writable:!0,value:o}),l}return(0,r.ZT)(t,e),Object.defineProperty(t.prototype,"path",{enumerable:!1,configurable:!0,writable:!0,value:function(e){this.radius>0&&e.arc(this.cx,this.cy,this.radius,this.startAngle,this.endAngle,this.anticlockwise)}}),Object.defineProperty(t.prototype,"addBounds",{enumerable:!1,configurable:!0,writable:!0,value:function(e){var t=d.E4(this.cx,this.cy,this.startAngle*d.v4,this.endAngle*d.v4,this.radius);B(e,{x:t.left,y:t.top}),B(e,{x:t.right,y:t.bottom})}}),t}(S),V=function(e){function t(t,i,r,n,a){var o=e.call(this)||this;return Object.defineProperty(o,"x1",{enumerable:!0,configurable:!0,writable:!0,value:t}),Object.defineProperty(o,"y1",{enumerable:!0,configurable:!0,writable:!0,value:i}),Object.defineProperty(o,"x2",{enumerable:!0,configurable:!0,writable:!0,value:r}),Object.defineProperty(o,"y2",{enumerable:!0,configurable:!0,writable:!0,value:n}),Object.defineProperty(o,"radius",{enumerable:!0,configurable:!0,writable:!0,value:a}),o}return(0,r.ZT)(t,e),Object.defineProperty(t.prototype,"path",{enumerable:!1,configurable:!0,writable:!0,value:function(e){this.radius>0&&e.arcTo(this.x1,this.y1,this.x2,this.y2,this.radius)}}),Object.defineProperty(t.prototype,"addBounds",{enumerable:!1,configurable:!0,writable:!0,value:function(e){}}),t}(S),R=function(e){function t(t,i){var r=e.call(this)||this;return Object.defineProperty(r,"x",{enumerable:!0,configurable:!0,writable:!0,value:t}),Object.defineProperty(r,"y",{enumerable:!0,configurable:!0,writable:!0,value:i}),r}return(0,r.ZT)(t,e),Object.defineProperty(t.prototype,"path",{enumerable:!1,configurable:!0,writable:!0,value:function(e){e.lineTo(this.x,this.y)}}),Object.defineProperty(t.prototype,"addBounds",{enumerable:!1,configurable:!0,writable:!0,value:function(e){B(e,{x:this.x,y:this.y})}}),t}(S),X=function(e){function t(t,i){var r=e.call(this)||this;return Object.defineProperty(r,"x",{enumerable:!0,configurable:!0,writable:!0,value:t}),Object.defineProperty(r,"y",{enumerable:!0,configurable:!0,writable:!0,value:i}),r}return(0,r.ZT)(t,e),Object.defineProperty(t.prototype,"path",{enumerable:!1,configurable:!0,writable:!0,value:function(e){e.moveTo(this.x,this.y)}}),Object.defineProperty(t.prototype,"addBounds",{enumerable:!1,configurable:!0,writable:!0,value:function(e){B(e,{x:this.x,y:this.y})}}),t}(S),z=function(e){function t(){return null!==e&&e.apply(this,arguments)||this}return(0,r.ZT)(t,e),Object.defineProperty(t.prototype,"path",{enumerable:!1,configurable:!0,writable:!0,value:function(e){e.closePath()}}),t}(S),H=function(e){function t(t,i,r,n,a,o){var l=e.call(this)||this;return Object.defineProperty(l,"cpX",{enumerable:!0,configurable:!0,writable:!0,value:t}),Object.defineProperty(l,"cpY",{enumerable:!0,configurable:!0,writable:!0,value:i}),Object.defineProperty(l,"cpX2",{enumerable:!0,configurable:!0,writable:!0,value:r}),Object.defineProperty(l,"cpY2",{enumerable:!0,configurable:!0,writable:!0,value:n}),Object.defineProperty(l,"toX",{enumerable:!0,configurable:!0,writable:!0,value:a}),Object.defineProperty(l,"toY",{enumerable:!0,configurable:!0,writable:!0,value:o}),l}return(0,r.ZT)(t,e),Object.defineProperty(t.prototype,"path",{enumerable:!1,configurable:!0,writable:!0,value:function(e){e.bezierCurveTo(this.cpX,this.cpY,this.cpX2,this.cpY2,this.toX,this.toY)}}),Object.defineProperty(t.prototype,"addBounds",{enumerable:!1,configurable:!0,writable:!0,value:function(e){B(e,{x:this.cpX,y:this.cpY}),B(e,{x:this.cpX2,y:this.cpY2}),B(e,{x:this.toX,y:this.toY})}}),t}(S),Z=function(e){function t(t,i,r,n){var a=e.call(this)||this;return Object.defineProperty(a,"cpX",{enumerable:!0,configurable:!0,writable:!0,value:t}),Object.defineProperty(a,"cpY",{enumerable:!0,configurable:!0,writable:!0,value:i}),Object.defineProperty(a,"toX",{enumerable:!0,configurable:!0,writable:!0,value:r}),Object.defineProperty(a,"toY",{enumerable:!0,configurable:!0,writable:!0,value:n}),a}return(0,r.ZT)(t,e),Object.defineProperty(t.prototype,"path",{enumerable:!1,configurable:!0,writable:!0,value:function(e){e.quadraticCurveTo(this.cpX,this.cpY,this.toX,this.toY)}}),Object.defineProperty(t.prototype,"addBounds",{enumerable:!1,configurable:!0,writable:!0,value:function(e){B(e,{x:this.cpX,y:this.cpY}),B(e,{x:this.toX,y:this.toY})}}),t}(S),F=function(e){function t(t,i,r,n,a){var o=e.call(this)||this;return Object.defineProperty(o,"color",{enumerable:!0,configurable:!0,writable:!0,value:t}),Object.defineProperty(o,"blur",{enumerable:!0,configurable:!0,writable:!0,value:i}),Object.defineProperty(o,"offsetX",{enumerable:!0,configurable:!0,writable:!0,value:r}),Object.defineProperty(o,"offsetY",{enumerable:!0,configurable:!0,writable:!0,value:n}),Object.defineProperty(o,"opacity",{enumerable:!0,configurable:!0,writable:!0,value:a}),o}return(0,r.ZT)(t,e),Object.defineProperty(t.prototype,"colorize",{enumerable:!1,configurable:!0,writable:!0,value:function(e,t){this.opacity&&(e.fillStyle=this.color),e.shadowColor=this.color,e.shadowBlur=this.blur,e.shadowOffsetX=this.offsetX,e.shadowOffsetY=this.offsetY}}),t}(S),W=function(e){function t(t,i,r,n,a){var o=e.call(this)||this;return Object.defineProperty(o,"image",{enumerable:!0,configurable:!0,writable:!0,value:t}),Object.defineProperty(o,"width",{enumerable:!0,configurable:!0,writable:!0,value:i}),Object.defineProperty(o,"height",{enumerable:!0,configurable:!0,writable:!0,value:r}),Object.defineProperty(o,"x",{enumerable:!0,configurable:!0,writable:!0,value:n}),Object.defineProperty(o,"y",{enumerable:!0,configurable:!0,writable:!0,value:a}),o}return(0,r.ZT)(t,e),Object.defineProperty(t.prototype,"path",{enumerable:!1,configurable:!0,writable:!0,value:function(e){e.drawImage(this.image,this.x,this.y,this.width,this.height)}}),Object.defineProperty(t.prototype,"addBounds",{enumerable:!1,configurable:!0,writable:!0,value:function(e){B(e,{x:this.x,y:this.y}),B(e,{x:this.width,y:this.height})}}),t}(S),G=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return Object.defineProperty(t,"_operations",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(t,"blendMode",{enumerable:!0,configurable:!0,writable:!0,value:n.b.NORMAL}),Object.defineProperty(t,"_hasShadows",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(t,"_fillAlpha",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(t,"_strokeAlpha",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),t}return(0,r.ZT)(t,e),Object.defineProperty(t.prototype,"clear",{enumerable:!1,configurable:!0,writable:!0,value:function(){e.prototype.clear.call(this),this._operations.length=0}}),Object.defineProperty(t.prototype,"_pushOp",{enumerable:!1,configurable:!0,writable:!0,value:function(e){this._operations.push(e)}}),Object.defineProperty(t.prototype,"beginFill",{enumerable:!1,configurable:!0,writable:!0,value:function(e,t){void 0===t&&(t=1),this._fillAlpha=t,e?e instanceof a.Il?this._pushOp(new C(e.toCSS(t))):(this.isMeasured=!0,this._pushOp(new C(e))):this._pushOp(new C("rgba(0, 0, 0, "+t+")"))}}),Object.defineProperty(t.prototype,"endFill",{enumerable:!1,configurable:!0,writable:!0,value:function(){this._pushOp(new T(this._hasShadows))}}),Object.defineProperty(t.prototype,"endStroke",{enumerable:!1,configurable:!0,writable:!0,value:function(){this._pushOp(new k)}}),Object.defineProperty(t.prototype,"lineStyle",{enumerable:!1,configurable:!0,writable:!0,value:function(e,t,i,r){void 0===e&&(e=0),void 0===i&&(i=1),this._strokeAlpha=i,t?t instanceof a.Il?this._pushOp(new A(e,t.toCSS(i),r)):this._pushOp(new A(e,t,r)):this._pushOp(new A(e,"rgba(0, 0, 0, "+i+")",r))}}),Object.defineProperty(t.prototype,"setLineDash",{enumerable:!1,configurable:!0,writable:!0,value:function(e){this._pushOp(new E(e||[]))}}),Object.defineProperty(t.prototype,"setLineDashOffset",{enumerable:!1,configurable:!0,writable:!0,value:function(e){void 0===e&&(e=0),this._pushOp(new M(e))}}),Object.defineProperty(t.prototype,"drawRect",{enumerable:!1,configurable:!0,writable:!0,value:function(e,t,i,r){this._pushOp(new L(e,t,i,r))}}),Object.defineProperty(t.prototype,"drawCircle",{enumerable:!1,configurable:!0,writable:!0,value:function(e,t,i){this._pushOp(new I(e,t,i))}}),Object.defineProperty(t.prototype,"drawEllipse",{enumerable:!1,configurable:!0,writable:!0,value:function(e,t,i,r){this._pushOp(new D(e,t,i,r))}}),Object.defineProperty(t.prototype,"arc",{enumerable:!1,configurable:!0,writable:!0,value:function(e,t,i,r,n,a){void 0===a&&(a=!1),this._pushOp(new Y(e,t,i,r,n,a))}}),Object.defineProperty(t.prototype,"arcTo",{enumerable:!1,configurable:!0,writable:!0,value:function(e,t,i,r,n){this._pushOp(new V(e,t,i,r,n))}}),Object.defineProperty(t.prototype,"lineTo",{enumerable:!1,configurable:!0,writable:!0,value:function(e,t){this._pushOp(new R(e,t))}}),Object.defineProperty(t.prototype,"moveTo",{enumerable:!1,configurable:!0,writable:!0,value:function(e,t){this._pushOp(new X(e,t))}}),Object.defineProperty(t.prototype,"bezierCurveTo",{enumerable:!1,configurable:!0,writable:!0,value:function(e,t,i,r,n,a){this._pushOp(new H(e,t,i,r,n,a))}}),Object.defineProperty(t.prototype,"quadraticCurveTo",{enumerable:!1,configurable:!0,writable:!0,value:function(e,t,i,r){this._pushOp(new Z(e,t,i,r))}}),Object.defineProperty(t.prototype,"closePath",{enumerable:!1,configurable:!0,writable:!0,value:function(){this._pushOp(new z)}}),Object.defineProperty(t.prototype,"shadow",{enumerable:!1,configurable:!0,writable:!0,value:function(e,t,i,r,n){void 0===t&&(t=0),void 0===i&&(i=0),void 0===r&&(r=0),this._hasShadows=!0,this._pushOp(new F(n?e.toCSS(n):e.toCSS(this._fillAlpha||this._strokeAlpha),t,i,r))}}),Object.defineProperty(t.prototype,"image",{enumerable:!1,configurable:!0,writable:!0,value:function(e,t,i,r,n){this._pushOp(new W(e,t,i,r,n))}}),Object.defineProperty(t.prototype,"svgPath",{enumerable:!1,configurable:!0,writable:!0,value:function(e){for(var t,i=this,r=0,n=0,a=null,o=null,l=null,u=null,s=/([MmZzLlHhVvCcSsQqTtAa])([^MmZzLlHhVvCcSsQqTtAa]*)/g,c=/[\u0009\u0020\u000A\u000C\u000D]*([\+\-]?[0-9]*\.?[0-9]+(?:[eE][\+\-]?[0-9]+)?)[\u0009\u0020\u000A\u000C\u000D]*,?/g;null!==(t=s.exec(e));){for(var b=t[1],f=t[2],d=[];null!==(t=c.exec(f));)d.push(+t[1]);switch("S"!==b&&"s"!==b&&"C"!==b&&"c"!==b&&(a=null,o=null),"Q"!==b&&"q"!==b&&"T"!==b&&"t"!==b&&(l=null,u=null),b){case"M":g(b,d.length,2),r=d[0],n=d[1],this.moveTo(r,n);for(var w=2;w<d.length;w+=2)r=d[w],n=d[w+1],this.lineTo(r,n);break;case"m":g(b,d.length,2),r+=d[0],n+=d[1],this.moveTo(r,n);for(var w=2;w<d.length;w+=2)r+=d[w],n+=d[w+1],this.lineTo(r,n);break;case"L":g(b,d.length,2);for(var w=0;w<d.length;w+=2)r=d[w],n=d[w+1],this.lineTo(r,n);break;case"l":g(b,d.length,2);for(var w=0;w<d.length;w+=2)r+=d[w],n+=d[w+1],this.lineTo(r,n);break;case"H":v(b,d.length,1);for(var w=0;w<d.length;++w)r=d[w],this.lineTo(r,n);break;case"h":v(b,d.length,1);for(var w=0;w<d.length;++w)r+=d[w],this.lineTo(r,n);break;case"V":v(b,d.length,1);for(var w=0;w<d.length;++w)n=d[w],this.lineTo(r,n);break;case"v":v(b,d.length,1);for(var w=0;w<d.length;++w)n+=d[w],this.lineTo(r,n);break;case"C":g(b,d.length,6);for(var w=0;w<d.length;w+=6){var m=d[w],_=d[w+1];a=d[w+2],o=d[w+3],r=d[w+4],n=d[w+5],this.bezierCurveTo(m,_,a,o,r,n)}break;case"c":g(b,d.length,6);for(var w=0;w<d.length;w+=6){var m=d[w]+r,_=d[w+1]+n;a=d[w+2]+r,o=d[w+3]+n,r+=d[w+4],n+=d[w+5],this.bezierCurveTo(m,_,a,o,r,n)}break;case"S":g(b,d.length,4),(null===a||null===o)&&(a=r,o=n);for(var w=0;w<d.length;w+=4){var m=2*r-a,_=2*n-o;a=d[w],o=d[w+1],r=d[w+2],n=d[w+3],this.bezierCurveTo(m,_,a,o,r,n)}break;case"s":g(b,d.length,4),(null===a||null===o)&&(a=r,o=n);for(var w=0;w<d.length;w+=4){var m=2*r-a,_=2*n-o;a=d[w]+r,o=d[w+1]+n,r+=d[w+2],n+=d[w+3],this.bezierCurveTo(m,_,a,o,r,n)}break;case"Q":g(b,d.length,4);for(var w=0;w<d.length;w+=4)l=d[w],u=d[w+1],r=d[w+2],n=d[w+3],this.quadraticCurveTo(l,u,r,n);break;case"q":g(b,d.length,4);for(var w=0;w<d.length;w+=4)l=d[w]+r,u=d[w+1]+n,r+=d[w+2],n+=d[w+3],this.quadraticCurveTo(l,u,r,n);break;case"T":g(b,d.length,2),(null===l||null===u)&&(l=r,u=n);for(var w=0;w<d.length;w+=2)l=2*r-l,u=2*n-u,r=d[w],n=d[w+1],this.quadraticCurveTo(l,u,r,n);break;case"t":g(b,d.length,2),(null===l||null===u)&&(l=r,u=n);for(var w=0;w<d.length;w+=2)l=2*r-l,u=2*n-u,r+=d[w],n+=d[w+1],this.quadraticCurveTo(l,u,r,n);break;case"A":case"a":var x="a"===b;g(b,d.length,7);for(var w=0;w<d.length;w+=7){var O=d[w+5],P=d[w+6];x&&(O+=r,P+=n);var j=(0,p.Z)({px:r,py:n,rx:d[w],ry:d[w+1],xAxisRotation:d[w+2],largeArcFlag:y(d[w+3]),sweepFlag:y(d[w+4]),cx:O,cy:P});h.S6(j,function(e){i.bezierCurveTo(e.x1,e.y1,e.x2,e.y2,e.x,e.y),r=e.x,n=e.y})}break;case"Z":case"z":(function(e,t,i){if(t!==i)throw Error("Required "+i+" arguments for "+e+" but got "+t)})(b,d.length,0),this.closePath()}}}}),Object.defineProperty(t.prototype,"_runPath",{enumerable:!1,configurable:!0,writable:!0,value:function(e){e.beginPath(),h.S6(this._operations,function(t){t.path(e)})}}),Object.defineProperty(t.prototype,"_render",{enumerable:!1,configurable:!0,writable:!0,value:function(t){e.prototype._render.call(this,t);var i=this._layer||t,r=i.dirty,n=this._isInteractive();if(r||n){var a,o=i.context,l=this._renderer._ghostContext;r&&(o.globalCompositeOperation=this.blendMode,o.beginPath()),n&&(l.beginPath(),a=this._getColorId()),h.S6(this._operations,function(e){r&&(e.path(o),e.colorize(o,void 0)),n&&(e.path(l),e.colorize(l,a))})}}}),Object.defineProperty(t.prototype,"renderDetached",{enumerable:!1,configurable:!0,writable:!0,value:function(e){if(this.visible){this._setMatrix(),e.save();var t=this.mask;t&&(t._setMatrix(),t._transform(e,1),t._runPath(e),e.clip()),e.globalAlpha=this.compoundAlpha*this.alpha,this._transform(e,1),this.filter&&(e.filter=this.filter),e.globalCompositeOperation=this.blendMode,e.beginPath(),h.S6(this._operations,function(t){t.path(e),t.colorize(e,void 0)}),e.restore()}}}),Object.defineProperty(t.prototype,"_addBounds",{enumerable:!1,configurable:!0,writable:!0,value:function(e){this.visible&&this.isMeasured&&h.S6(this._operations,function(t){t.addBounds(e)})}}),t}(P),q=function(e){function t(t,i,r){var n=e.call(this,t)||this;return Object.defineProperty(n,"text",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(n,"style",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(n,"resolution",{enumerable:!0,configurable:!0,writable:!0,value:1}),Object.defineProperty(n,"_textInfo",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(n,"_textVisible",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(n,"_originalScale",{enumerable:!0,configurable:!0,writable:!0,value:1}),n.text=i,n.style=r,n}return(0,r.ZT)(t,e),Object.defineProperty(t.prototype,"invalidateBounds",{enumerable:!1,configurable:!0,writable:!0,value:function(){e.prototype.invalidateBounds.call(this),this._textInfo=void 0}}),Object.defineProperty(t.prototype,"_shared",{enumerable:!1,configurable:!0,writable:!0,value:function(e){this.style.textAlign&&(e.textAlign=this.style.textAlign),this.style.direction&&(e.direction=this.style.direction),this.style.textBaseline&&(e.textBaseline=this.style.textBaseline)}}),Object.defineProperty(t.prototype,"_prerender",{enumerable:!1,configurable:!0,writable:!0,value:function(t,i,r){void 0===i&&(i=!1),void 0===r&&(r=!1),e.prototype._render.call(this,t);var n=t.context,o=this._renderer._ghostContext,l=this.style,u=this._getFontStyle(void 0,r);n.font=u,this._isInteractive()&&!i&&(o.font=u),l.fill&&(l.fill instanceof a.Il?n.fillStyle=l.fill.toCSS():n.fillStyle=l.fill),l.shadowColor&&(t.context.shadowColor=l.shadowColor.toCSS(l.shadowOpacity||1)),l.shadowBlur&&(t.context.shadowBlur=l.shadowBlur),l.shadowOffsetX&&(t.context.shadowOffsetX=l.shadowOffsetX),l.shadowOffsetY&&(t.context.shadowOffsetY=l.shadowOffsetY),this._shared(n),this._isInteractive()&&!i&&(o.fillStyle=this._getColorId(),this._shared(o))}}),Object.defineProperty(t.prototype,"_getFontStyle",{enumerable:!1,configurable:!0,writable:!0,value:function(e,t){void 0===t&&(t=!1);var i=this.style,r=[];return e&&e.fontVariant?r.push(e.fontVariant):i.fontVariant&&r.push(i.fontVariant),!t&&(e&&e.fontWeight?r.push(e.fontWeight):i.fontWeight&&r.push(i.fontWeight)),e&&e.fontStyle?r.push(e.fontStyle):i.fontStyle&&r.push(i.fontStyle),e&&e.fontSize?(f.hj(e.fontSize)&&(e.fontSize=e.fontSize+"px"),r.push(e.fontSize)):i.fontSize&&(f.hj(i.fontSize)&&(i.fontSize=i.fontSize+"px"),r.push(i.fontSize)),e&&e.fontFamily?r.push(e.fontFamily):i.fontFamily?r.push(i.fontFamily):r.length&&r.push("Arial"),r.join(" ")}}),Object.defineProperty(t.prototype,"_render",{enumerable:!1,configurable:!0,writable:!0,value:function(e){var t=this,i=this._layer||e;if(this._textInfo||this._measure(i),this._textVisible){var r=this._isInteractive(),n=i.context,o=i.dirty,l=this._renderer._ghostContext;n.save(),l.save(),this._prerender(i),h.S6(this._textInfo,function(e,i){h.S6(e.textChunks,function(i,u){if(i.style&&(n.save(),l.save(),n.font=i.style,t._isInteractive()&&(l.font=i.style)),i.fill&&(n.save(),n.fillStyle=i.fill.toCSS()),o&&n.fillText(i.text,i.offsetX,e.offsetY+i.offsetY),"underline"==i.textDecoration||"line-through"==i.textDecoration){var c=1,h=1,b=i.height,f=i.offsetX;switch(t.style.textAlign){case"right":case"end":f-=i.width;break;case"center":f-=i.width/2}if(i.style){var d=s.V.getTextStyle(i.style);switch(d.fontWeight){case"bolder":case"bold":case"700":case"800":case"900":c=2}}b&&(h=b/20);var p=void 0;p="line-through"==i.textDecoration?c+e.offsetY+i.offsetY-i.height/2:c+1.5*h+e.offsetY+i.offsetY,n.save(),n.beginPath(),i.fill?n.strokeStyle=i.fill.toCSS():t.style.fill&&t.style.fill instanceof a.Il&&(n.strokeStyle=t.style.fill.toCSS()),n.lineWidth=c*h,n.moveTo(f,p),n.lineTo(f+i.width,p),n.stroke(),n.restore()}r&&t.interactive&&l.fillText(i.text,i.offsetX,e.offsetY+i.offsetY),i.fill&&n.restore(),i.style&&(n.restore(),l.restore())})}),n.restore(),l.restore()}}}),Object.defineProperty(t.prototype,"_addBounds",{enumerable:!1,configurable:!0,writable:!0,value:function(e){if(this.visible&&this.isMeasured){var t=this._measure(this.getLayer());B(e,{x:t.left,y:t.top}),B(e,{x:t.right,y:t.bottom})}}}),Object.defineProperty(t.prototype,"_measure",{enumerable:!1,configurable:!0,writable:!0,value:function(e){var t,i=this,r=e.context,n=this._renderer._ghostContext,a="rtl"==this.style.direction;this._textInfo=[];var o=this.style.oversizedBehavior,u=this.style.maxWidth,b=f.hj(u)&&"truncate"==o,d=f.hj(u)&&("wrap"==o||"wrap-no-break"==o);r.save(),n.save(),this._prerender(e,!0,!0);var p="abcdefghijklmnopqrstuvwxyzABCDEFGHIJKLMNOPQRSTUVWXYZ0123456789 ",v=this.text.toString().replace(/\r/g,"").split(/\n/),g=!0,y=0,w=0,m=0;h.S6(v,function(e,a){var o;for(o=""==e?[{type:"value",text:""}]:s.V.chunk(e,!1,i.style.ignoreFormatting);o.length>0;)!function(){var e,a,v,_,x={offsetY:m,ascent:0,width:0,height:0,left:0,right:0,textChunks:[]},O=i._measureText(p,r),P=O.actualBoundingBoxAscent+O.actualBoundingBoxDescent;x.height=P,x.ascent=O.actualBoundingBoxAscent;var j=i.style.textDecoration,B=!1,S=!0,C=[];h.vn(o,function(l,h){if("format"==l.type){if("[/]"==l.text)g||(r.restore(),n.restore(),g=!0),a=void 0,t=void 0,v=void 0,j=i.style.textDecoration,_=void 0,e=l.text;else{g||(r.restore(),n.restore());var y=s.V.getTextStyle(l.text),w=i._getFontStyle(y);r.save(),n.save(),r.font=w,t=w,e=l.text,y.textDecoration&&(j=y.textDecoration),y.fill&&(a=y.fill),y.width&&(v=f.He(y.width)),y.verticalAlign&&(_=y.verticalAlign),g=!1;var m=i._measureText(p,r),O=m.actualBoundingBoxAscent+m.actualBoundingBoxDescent;O>x.height&&(x.height=O),m.actualBoundingBoxAscent>x.ascent&&(x.ascent=m.actualBoundingBoxAscent)}}else if("value"==l.type&&!B){var P=i._measureText(l.text,r),T=P.actualBoundingBoxLeft+P.actualBoundingBoxRight;if(b){var k=S||i.style.breakWords||!1,A=i.style.ellipsis||"",E=i._measureText(A,r),M=E.actualBoundingBoxLeft+E.actualBoundingBoxRight;if(x.width+T>u){var L=u-x.width-M;l.text=i._truncateText(r,l.text,L,k),l.text+=A,B=!0}}else if(d&&x.width+T>u){var L=u-x.width,I=i._truncateText(r,l.text,L,!1,S&&"wrap-no-break"!=i.style.oversizedBehavior);if(""==I)return i._textVisible=!0,!1;C=o.slice(h+1),c.fy(I)!=c.fy(l.text)&&(C.unshift({type:"value",text:l.text.substr(I.length)}),e&&C.unshift({type:"format",text:e})),l.text=c.fy(I),o=[],B=!0}var D=1,Y=1;if(t&&v&&v>T){var V=T/v;switch(i.style.textAlign){case"right":case"end":D=V;break;case"center":D=V,Y=V;break;default:Y=V}T=v}var R=P.actualBoundingBoxAscent+P.actualBoundingBoxDescent;R>x.height&&(x.height=R),P.actualBoundingBoxAscent>x.ascent&&(x.ascent=P.actualBoundingBoxAscent),x.width+=T,x.left+=P.actualBoundingBoxLeft/D,x.right+=P.actualBoundingBoxRight/Y,x.textChunks.push({style:t,fill:a,text:l.text,width:T,height:R,left:P.actualBoundingBoxLeft,right:P.actualBoundingBoxRight,ascent:P.actualBoundingBoxAscent,offsetX:0,offsetY:0,textDecoration:j,verticalAlign:_}),S=!1}return!0}),i.style.lineHeight instanceof l.gG?(x.height*=i.style.lineHeight.value,x.ascent*=i.style.lineHeight.value):(x.height*=i.style.lineHeight||1.2,x.ascent*=i.style.lineHeight||1.2),y<x.left&&(y=x.left),w<x.right&&(w=x.right),i._textInfo.push(x),m+=x.height,o=C||[]}()}),g||(r.restore(),n.restore()),h.S6(this._textInfo,function(e,t){var r=0;h.S6(e.textChunks,function(t){if(t.offsetX=r+t.left-e.left,t.offsetY+=e.height-e.height*(i.style.baselineRatio||.19),r+=t.width,t.verticalAlign)switch(t.verticalAlign){case"super":t.offsetY-=e.height/2-t.height/2;break;case"sub":t.offsetY+=t.height/2}})});var _={left:a?-w:-y,top:0,right:a?y:w,bottom:m};if("none"!==o){var x=this._fitRatio(_);if(x<1){if("fit"==o)f.hj(this.style.minScale)&&x<this.style.minScale?this._textVisible=!1:(this._originalScale&&1!=this._originalScale||(this._originalScale=this.scale),this.scale=x,this._textVisible=!0);else if("hide"==o)this._textVisible=!1;else{switch(this.style.textAlign){case"right":case"end":_.left=-u,_.right=0;break;case"center":_.left=-u/2,_.right=u/2;break;default:_.left=0,_.right=u}this.scale=this._originalScale||1,this._originalScale=void 0,this._textVisible=!0}}else this.scale=this._originalScale||1,this._originalScale=void 0,this._textVisible=!0}return r.restore(),n.restore(),_}}),Object.defineProperty(t.prototype,"_fitRatio",{enumerable:!1,configurable:!0,writable:!0,value:function(e){var t=this.style.maxWidth,i=this.style.maxHeight;return f.hj(t)||f.hj(i)?Math.min(t/(e.right-e.left)||1,i/(e.bottom-e.top)||1):1}}),Object.defineProperty(t.prototype,"_truncateText",{enumerable:!1,configurable:!0,writable:!0,value:function(e,t,i,r,n){void 0===r&&(r=!1),void 0===n&&(n=!0);do{if(r)t=t.slice(0,-1);else{var a,o=t.replace(/[^,;:!?\\\/\s]+[,;:!?\\\/\s]*$/g,"");if(""==o&&n)r=!0;else if(""==o)break;else t=o}var l=this._measureText(t,e);a=l.actualBoundingBoxLeft+l.actualBoundingBoxRight}while(a>i&&""!=t);return t}}),Object.defineProperty(t.prototype,"_measureText",{enumerable:!1,configurable:!0,writable:!0,value:function(e,t){var i=t.measureText(e),r={};if(null==i.actualBoundingBoxAscent){var n=document.createElement("div");n.innerText=e,n.style.visibility="hidden",n.style.position="absolute",n.style.top="-1000000px;",n.style.fontFamily=this.style.fontFamily||"",n.style.fontSize=this.style.fontSize+"",document.body.appendChild(n);var a=n.getBoundingClientRect();document.body.removeChild(n);var o=a.height,l=i.width;r={actualBoundingBoxAscent:o,actualBoundingBoxDescent:0,actualBoundingBoxLeft:0,actualBoundingBoxRight:l,fontBoundingBoxAscent:o,fontBoundingBoxDescent:0,width:l}}else r={actualBoundingBoxAscent:i.actualBoundingBoxAscent,actualBoundingBoxDescent:i.actualBoundingBoxDescent,actualBoundingBoxLeft:i.actualBoundingBoxLeft,actualBoundingBoxRight:i.actualBoundingBoxRight,fontBoundingBoxAscent:i.actualBoundingBoxAscent,fontBoundingBoxDescent:i.actualBoundingBoxDescent,width:i.width};var u=i.width;switch(this.style.textAlign){case"right":case"end":r.actualBoundingBoxLeft=u,r.actualBoundingBoxRight=0;break;case"center":r.actualBoundingBoxLeft=u/2,r.actualBoundingBoxRight=u/2;break;default:r.actualBoundingBoxLeft=0,r.actualBoundingBoxRight=u}return r}}),t}(P),N=function(){Object.defineProperty(this,"fill",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"textAlign",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"fontFamily",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"fontSize",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"fontWeight",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"fontStyle",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"fontVariant",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"textDecoration",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"shadowColor",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"shadowBlur",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"shadowOffsetX",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"shadowOffsetY",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"shadowOpacity",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"lineHeight",{enumerable:!0,configurable:!0,writable:!0,value:(0,l.aQ)(120)}),Object.defineProperty(this,"baselineRatio",{enumerable:!0,configurable:!0,writable:!0,value:.19}),Object.defineProperty(this,"direction",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"textBaseline",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"oversizedBehavior",{enumerable:!0,configurable:!0,writable:!0,value:"none"}),Object.defineProperty(this,"breakWords",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"ellipsis",{enumerable:!0,configurable:!0,writable:!0,value:"…"}),Object.defineProperty(this,"maxWidth",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"maxHeight",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"minScale",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"ignoreFormatting",{enumerable:!0,configurable:!0,writable:!0,value:!1})},J=function(e){function t(){var t=null!==e&&e.apply(this,arguments)||this;return Object.defineProperty(t,"textType",{enumerable:!0,configurable:!0,writable:!0,value:"circular"}),Object.defineProperty(t,"radius",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(t,"startAngle",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(t,"inside",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(t,"orientation",{enumerable:!0,configurable:!0,writable:!0,value:"auto"}),Object.defineProperty(t,"kerning",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(t,"_textReversed",{enumerable:!0,configurable:!0,writable:!0,value:!1}),t}return(0,r.ZT)(t,e),Object.defineProperty(t.prototype,"_render",{enumerable:!1,configurable:!0,writable:!0,value:function(t){"circular"===this.textType?this._renderCircular(t):e.prototype._render.call(this,t)}}),Object.defineProperty(t.prototype,"_renderCircular",{enumerable:!1,configurable:!0,writable:!0,value:function(e){var t=this._layer||e;this._prerender(t);var i=this._isInteractive(),r=t.context,n=t.dirty,a=this._renderer._ghostContext;r.save(),i&&a.save();var o=this.radius||0,l=this.startAngle||0,u=0,s=this.orientation,c="auto"==s?"auto":"inward"==s,b=this.inside,f=this.style.textAlign||"left",p=this.kerning||0,v="left"==f?1:-1,g=!this._textReversed;if(this._textInfo||this._measure(t),"auto"==c){var y=0,w=0;h.S6(this._textInfo,function(e,t){var i=l+-(e.width/(o-e.height)/2*v);i>y&&(y=i)}),w="left"==f?(y+u/2)*d.v4:"right"==f?(y-u/2)*d.v4:l*d.v4,c=(w=d.LW(w))>=270||w<=90}!0==c&&g&&(this._textInfo.reverse(),this._textReversed=!0),h.S6(this._textInfo,function(e,t){var s=e.height;b||(o+=s),(-1==v&&c||1==v&&!c)&&g&&e.textChunks.reverse();var d=l;u=0,"center"==f&&(d+=-(e.width/(o-s)/2*v),u=d-l),d+=Math.PI*(c?0:1),r.save(),i&&a.save(),r.rotate(d),i&&a.rotate(d);var y=0;h.S6(e.textChunks,function(e,t){var l=e.text,u=e.width;y=u/2/(o-s)*v,r.rotate(y),i&&a.rotate(y),e.style&&(r.save(),a.save(),r.font=e.style,i&&(a.font=e.style)),e.fill&&(r.save(),r.fillStyle=e.fill.toCSS()),r.textBaseline="middle",r.textAlign="center",i&&(a.textBaseline="middle",a.textAlign="center"),n&&r.fillText(l,0,(c?1:-1)*(0-o+s/2)),i&&a.fillText(l,0,(c?1:-1)*(0-o+s/2)),e.fill&&r.restore(),e.style&&(r.restore(),a.restore()),y=(u/2+p)/(o-s)*v,r.rotate(y),i&&a.rotate(y)}),r.restore(),i&&a.restore(),b&&(o-=s)}),r.restore(),i&&a.restore()}}),Object.defineProperty(t.prototype,"_measure",{enumerable:!1,configurable:!0,writable:!0,value:function(t){return"circular"===this.textType?this._measureCircular(t):e.prototype._measure.call(this,t)}}),Object.defineProperty(t.prototype,"_measureCircular",{enumerable:!1,configurable:!0,writable:!0,value:function(e){var t=this,i=e.context,r=this._renderer._ghostContext,n="rtl"==this.style.direction;this._textInfo=[],this._textReversed=!1,i.save(),r.save(),this._prerender(e,!0);var a=this.text.toString().replace(/\r/g,"").split(/\n/),o=!0,u=0;return h.S6(a,function(e,a){var c,b,d,p=s.V.chunk(e,!1,t.style.ignoreFormatting),v={offsetY:u,ascent:0,width:0,height:0,left:0,right:0,textChunks:[]};h.S6(p,function(e,a){if("format"==e.type){if("[/]"==e.text)o||(i.restore(),r.restore(),o=!0),b=void 0,c=void 0,d=void 0;else{var l=s.V.getTextStyle(e.text),u=t._getFontStyle(l);i.save(),r.save(),i.font=u,c=u,l.fill&&(b=l.fill),l.width&&(d=f.He(l.width)),o=!1}}else if("value"==e.type){var h=e.text.match(/./ug)||[];n&&h.reverse();for(var p=0;p<h.length;p++){var g=h[p],y=t._measureText(g,i),w=y.width;c&&d&&d>w&&(w=d);var m=y.actualBoundingBoxAscent+y.actualBoundingBoxDescent;if(m>v.height&&(v.height=m),y.actualBoundingBoxAscent>v.ascent&&(v.ascent=y.actualBoundingBoxAscent),v.width+=w,v.left+=y.actualBoundingBoxLeft,v.right+=y.actualBoundingBoxRight,v.textChunks.push({style:c,fill:b,text:g,width:w,height:m+y.actualBoundingBoxDescent,left:y.actualBoundingBoxLeft,right:y.actualBoundingBoxRight,ascent:y.actualBoundingBoxAscent,offsetX:0,offsetY:m,textDecoration:void 0}),n)break}}}),t.style.lineHeight instanceof l.gG?v.height*=t.style.lineHeight.value:v.height*=t.style.lineHeight||1.2,t._textInfo.push(v),u+=v.height}),o||(i.restore(),r.restore()),h.S6(this._textInfo,function(e){h.S6(e.textChunks,function(t){t.offsetY+=Math.round((e.height-t.height+(e.ascent-t.ascent))/2)})}),i.restore(),r.restore(),{left:0,top:0,right:0,bottom:0}}}),t}(q),Q=function(e){function t(t,i){var r=e.call(this,t)||this;return Object.defineProperty(r,"width",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(r,"height",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(r,"image",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(r,"tainted",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(r,"shadowColor",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(r,"shadowBlur",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(r,"shadowOffsetX",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(r,"shadowOffsetY",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(r,"shadowOpacity",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(r,"_imageMask",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),r.image=i,r}return(0,r.ZT)(t,e),Object.defineProperty(t.prototype,"_dispose",{enumerable:!1,configurable:!0,writable:!0,value:function(){e.prototype._dispose.call(this),this._imageMask&&x(this._imageMask)}}),Object.defineProperty(t.prototype,"getLocalBounds",{enumerable:!1,configurable:!0,writable:!0,value:function(){if(!this._localBounds){var e=0,t=0;this.width&&(e=this.width),this.height&&(t=this.height),this._localBounds={left:0,top:0,right:e,bottom:t},this._addBounds(this._localBounds)}return this._localBounds}}),Object.defineProperty(t.prototype,"_render",{enumerable:!1,configurable:!0,writable:!0,value:function(t){if(e.prototype._render.call(this,t),this.image){var i=this._layer||t;if(void 0===this.tainted&&(this.tainted=_(this.image),i.tainted=!0),!this.tainted||!this._renderer._omitTainted){if(i.dirty){this.shadowColor&&(i.context.shadowColor=this.shadowColor.toCSS(this.shadowOpacity||1)),this.shadowBlur&&(i.context.shadowBlur=this.shadowBlur),this.shadowOffsetX&&(i.context.shadowOffsetX=this.shadowOffsetX),this.shadowOffsetY&&(i.context.shadowOffsetY=this.shadowOffsetY);var r=this.width||this.image.naturalWidth,n=this.height||this.image.naturalHeight;i.context.drawImage(this.image,0,0,r,n)}if(this.interactive&&this._isInteractive()){var a=this._getMask(this.image);this._renderer._ghostContext.drawImage(a,0,0)}}}}}),Object.defineProperty(t.prototype,"clear",{enumerable:!1,configurable:!0,writable:!0,value:function(){e.prototype.clear.call(this),this.image=void 0,this._imageMask=void 0}}),Object.defineProperty(t.prototype,"_getMask",{enumerable:!1,configurable:!0,writable:!0,value:function(e){if(void 0===this._imageMask){var t=this.width||e.naturalWidth,i=this.height||e.naturalHeight,r=document.createElement("canvas");r.width=t,r.height=i;var n=r.getContext("2d");n.imageSmoothingEnabled=!1,n.fillStyle=this._getColorId(),n.fillRect(0,0,t,i),_(e)||(n.globalCompositeOperation="destination-in",n.drawImage(e,0,0,t,i)),this._imageMask=r}return this._imageMask}}),t}(P),K=function(e,t,i){Object.defineProperty(this,"event",{enumerable:!0,configurable:!0,writable:!0,value:e}),Object.defineProperty(this,"point",{enumerable:!0,configurable:!0,writable:!0,value:t}),Object.defineProperty(this,"bbox",{enumerable:!0,configurable:!0,writable:!0,value:i}),Object.defineProperty(this,"id",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(this,"simulated",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(this,"native",{enumerable:!0,configurable:!0,writable:!0,value:!0}),c.be("touchevents")&&e instanceof Touch?this.id=e.identifier:this.id=null},U=function(e){function t(t){var i=e.call(this)||this;if(Object.defineProperty(i,"view",{enumerable:!0,configurable:!0,writable:!0,value:document.createElement("div")}),Object.defineProperty(i,"_layerDom",{enumerable:!0,configurable:!0,writable:!0,value:document.createElement("div")}),Object.defineProperty(i,"layers",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(i,"_dirtyLayers",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(i,"defaultLayer",{enumerable:!0,configurable:!0,writable:!0,value:i.getLayer(0)}),Object.defineProperty(i,"_ghostView",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(i,"_ghostContext",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(i,"_patternCanvas",{enumerable:!0,configurable:!0,writable:!0,value:document.createElement("canvas")}),Object.defineProperty(i,"_patternContext",{enumerable:!0,configurable:!0,writable:!0,value:i._patternCanvas.getContext("2d")}),Object.defineProperty(i,"_width",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(i,"_height",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(i,"_clientWidth",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(i,"_clientHeight",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(i,"resolution",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(i,"interactionsEnabled",{enumerable:!0,configurable:!0,writable:!0,value:!0}),Object.defineProperty(i,"_listeners",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(i,"_events",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(i,"_colorId",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(i,"_colorMap",{enumerable:!0,configurable:!0,writable:!0,value:{}}),Object.defineProperty(i,"_forceInteractive",{enumerable:!0,configurable:!0,writable:!0,value:0}),Object.defineProperty(i,"_omitTainted",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(i,"_hovering",{enumerable:!0,configurable:!0,writable:!0,value:new Set}),Object.defineProperty(i,"_dragging",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(i,"_mousedown",{enumerable:!0,configurable:!0,writable:!0,value:[]}),Object.defineProperty(i,"_lastPointerMoveEvent",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),Object.defineProperty(i,"tapToActivate",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(i,"tapToActivateTimeout",{enumerable:!0,configurable:!0,writable:!0,value:3e3}),Object.defineProperty(i,"_touchActive",{enumerable:!0,configurable:!0,writable:!0,value:!1}),Object.defineProperty(i,"_touchActiveTimeout",{enumerable:!0,configurable:!0,writable:!0,value:void 0}),null==t?i.resolution=window.devicePixelRatio:i.resolution=t,i.view.style.position="absolute",i.view.appendChild(i._layerDom),i._disposers.push(new u.ku(function(){b.S6(i._events,function(e,t){t.disposer.dispose()}),h.S6(i.layers,function(e){x(e.view),e.exportableView&&x(e.exportableView)}),x(i._ghostView),x(i._patternCanvas)})),i._ghostView=document.createElement("canvas"),i._ghostContext=i._ghostView.getContext("2d",{alpha:!1,willReadFrequently:!0}),i._ghostContext.imageSmoothingEnabled=!1,i._ghostView.style.position="absolute",i._ghostView.style.top="0px",i._ghostView.style.left="0px",i._disposers.push(c.Oo(i._ghostView,"click",function(e){var t=i.getEvent(e);console.debug(i._getHitTarget(t.point,t.bbox))})),i._disposers.push(c.ap(function(){null==t&&(i.resolution=window.devicePixelRatio)})),c.be("touchevents")){var r=function(e){0!==i._dragging.length&&h.vn(i._dragging,function(t){return!t.value.shouldCancelTouch()||(e.preventDefault(),!1)}),i._touchActiveTimeout&&i._delayTouchDeactivate()};i._disposers.push(c.Oo(window,"touchstart",r,{passive:!1})),i._disposers.push(c.Oo(i.view,"touchstart",r,{passive:!1})),i._disposers.push(c.Oo(i.view,"touchmove",function(){i._touchActiveTimeout&&i._delayTouchDeactivate()},{passive:!0})),i._disposers.push(c.Oo(window,"click",function(e){i._touchActive=!1},{passive:!0})),i._disposers.push(c.Oo(i.view,"click",function(e){window.setTimeout(function(){i._touchActive=!0,i._delayTouchDeactivate()},100)},{passive:!0}))}return c.be("wheelevents")&&i._disposers.push(c.Oo(i.view,"wheel",function(e){var t=!1;i._hovering.forEach(function(e){if(e.wheelable)return t=!0,!1}),t&&e.preventDefault()},{passive:!1})),i}return(0,r.ZT)(t,e),Object.defineProperty(t.prototype,"_delayTouchDeactivate",{enumerable:!1,configurable:!0,writable:!0,value:function(){var e=this;this._touchActiveTimeout&&clearTimeout(this._touchActiveTimeout),this.tapToActivateTimeout>0&&(this._touchActiveTimeout=window.setTimeout(function(){e._touchActive=!1},this.tapToActivateTimeout))}}),Object.defineProperty(t.prototype,"debugGhostView",{get:function(){return!!this._ghostView.parentNode},set:function(e){e?this._ghostView.parentNode||this.view.appendChild(this._ghostView):this._ghostView.parentNode&&this._ghostView.parentNode.removeChild(this._ghostView)},enumerable:!1,configurable:!0}),Object.defineProperty(t.prototype,"createLinearGradient",{enumerable:!1,configurable:!0,writable:!0,value:function(e,t,i,r){return this.defaultLayer.context.createLinearGradient(e,t,i,r)}}),Object.defineProperty(t.prototype,"createRadialGradient",{enumerable:!1,configurable:!0,writable:!0,value:function(e,t,i,r,n,a){return this.defaultLayer.context.createRadialGradient(e,t,i,r,n,a)}}),Object.defineProperty(t.prototype,"createPattern",{enumerable:!1,configurable:!0,writable:!0,value:function(e,t,i,r,n){return this._patternCanvas.width=r,this._patternCanvas.height=n,this._patternContext.clearRect(0,0,r,n),t.renderDetached(this._patternContext),e.renderDetached(this._patternContext),this._patternContext.createPattern(this._patternCanvas,i)}}),Object.defineProperty(t.prototype,"makeContainer",{enumerable:!1,configurable:!0,writable:!0,value:function(){return new j(this)}}),Object.defineProperty(t.prototype,"makeGraphics",{enumerable:!1,configurable:!0,writable:!0,value:function(){return new G(this)}}),Object.defineProperty(t.prototype,"makeText",{enumerable:!1,configurable:!0,writable:!0,value:function(e,t){return new q(this,e,t)}}),Object.defineProperty(t.prototype,"makeTextStyle",{enumerable:!1,configurable:!0,writable:!0,value:function(){return new N}}),Object.defineProperty(t.prototype,"makeRadialText",{enumerable:!1,configurable:!0,writable:!0,value:function(e,t){return new J(this,e,t)}}),Object.defineProperty(t.prototype,"makePicture",{enumerable:!1,configurable:!0,writable:!0,value:function(e){return new Q(this,e)}}),Object.defineProperty(t.prototype,"resize",{enumerable:!1,configurable:!0,writable:!0,value:function(e,t){var i=this;this._clientWidth=e,this._clientHeight=t,this._width=Math.floor(e*this.resolution),this._height=Math.floor(t*this.resolution),h.S6(this.layers,function(r){r&&(r.dirty=!0,null!=r.width?(r.view.width=r.width,r.view.style.width=r.width+"px"):(r.view.width=i._width,r.view.style.width=e+"px"),null!=r.height?(r.view.height=r.height,r.view.style.height=r.height+"px"):(r.view.height=i._height,r.view.style.height=t+"px"))}),this._ghostView.width=this._width,this._ghostView.height=this._height,this._ghostView.style.width=e+"px",this._ghostView.style.height=t+"px",this.view.style.width=e+"px",this.view.style.height=t+"px"}}),Object.defineProperty(t.prototype,"createDetachedLayer",{enumerable:!1,configurable:!0,writable:!0,value:function(e){void 0===e&&(e=!1);var t=document.createElement("canvas"),i=t.getContext("2d",{willReadFrequently:e});return t.style.position="absolute",t.style.top="0px",t.style.left="0px",{view:t,context:i,order:0,visible:!0,width:void 0,height:void 0,dirty:!0,tainted:!1}}}),Object.defineProperty(t.prototype,"getLayerByOrder",{enumerable:!1,configurable:!0,writable:!0,value:function(e){for(var t=this.layers,i=t.length,r=0;r<i;r++){var n=t[r];if(n.order==e)return n}}}),Object.defineProperty(t.prototype,"getLayer",{enumerable:!1,configurable:!0,writable:!0,value:function(e,t){void 0===t&&(t=!0);var i,r=this.getLayerByOrder(e);if(r)return r;var n=this.createDetachedLayer(99==e);n.order=e,n.visible=t,n.visible&&this._width&&(n.view.width=this._width,n.view.style.width=this._clientWidth+"px",n.view.height=this._height,n.view.style.height=this._clientHeight+"px");var a=this.layers;a.push(n),a.sort(function(e,t){return e.order>t.order?1:e.order<t.order?-1:0});for(var o=a.length,l=h.cq(a,n),u=l+1;u<o;u++)if(a[u].visible){i=a[u];break}return n.visible&&(void 0===i?this._layerDom.appendChild(n.view):this._layerDom.insertBefore(n.view,i.view)),n}}),Object.defineProperty(t.prototype,"render",{enumerable:!1,configurable:!0,writable:!0,value:function(e){var t=this;if(this._dirtyLayers.length=0,h.S6(this.layers,function(e){if(e&&e.dirty&&e.visible){var i=e.context;t._dirtyLayers.push(e),i.save(),i.clearRect(0,0,t._width,t._height)}}),this._ghostContext.save(),this._ghostContext.fillStyle="#000",this._ghostContext.fillRect(0,0,this._width,this._height),e.render(this.defaultLayer),this._ghostContext.restore(),h.S6(this.layers,function(e){if(e){var t=e.context;t.beginPath(),t.moveTo(0,0),t.stroke()}}),h.S6(this._dirtyLayers,function(e){e.context.restore(),e.dirty=!1}),this._hovering.size&&this._lastPointerMoveEvent){var i=this._lastPointerMoveEvent.native;h.S6(this._lastPointerMoveEvent.events,function(e){t._dispatchGlobalMousemove(e,i)})}}}),Object.defineProperty(t.prototype,"paintId",{enumerable:!1,configurable:!0,writable:!0,value:function(e){var t=function(e){for(var t=[0,0,0],i=0;i<24;i++)t[i%3]<<=1,t[i%3]|=1&e,e>>=1;return(0|t[2])+(t[1]<<8)+(t[0]<<16)}(++this._colorId),i=a.Il.fromHex(t).toCSS();return this._colorMap[i]=e,i}}),Object.defineProperty(t.prototype,"_removeObject",{enumerable:!1,configurable:!0,writable:!0,value:function(e){void 0!==e._colorId&&delete this._colorMap[e._colorId]}}),Object.defineProperty(t.prototype,"getEvent",{enumerable:!1,configurable:!0,writable:!0,value:function(e,t){void 0===t&&(t=!0);var i=t?this.view.getBoundingClientRect():new DOMRect(0,0,0,0);return new K(e,e.clientX||e.clientY?{x:e.clientX-(e.clientX?i.left:0),y:e.clientY-(e.clientY?i.top:0)}:{x:0,y:0},i)}}),Object.defineProperty(t.prototype,"_getHitTarget",{enumerable:!1,configurable:!0,writable:!0,value:function(e,t){if(!(e.x<0)&&!(e.x>t.width)&&!(e.y<0)&&!(e.y>t.height)){var i=this._ghostContext.getImageData(Math.round(e.x/t.width*this._width),Math.round(e.y/t.height*this._height),1,1);if(0===i.data[0]&&0===i.data[1]&&0===i.data[2])return!1;var r=a.Il.fromRGB(i.data[0],i.data[1],i.data[2]).toCSS();return this._colorMap[r]}}}),Object.defineProperty(t.prototype,"_withEvents",{enumerable:!1,configurable:!0,writable:!0,value:function(e,t){var i=this._events[e];if(void 0!==i){i.dispatching=!0;try{t(i)}finally{i.dispatching=!1,i.cleanup&&(i.cleanup=!1,h.ZR(i.callbacks,function(e){return!e.disposed}),0===i.callbacks.length&&(i.disposer.dispose(),delete this._events[e]))}}}}),Object.defineProperty(t.prototype,"_dispatchEventAll",{enumerable:!1,configurable:!0,writable:!0,value:function(e,t){this.interactionsEnabled&&this._withEvents(e,function(e){h.S6(e.callbacks,function(e){e.disposed||e.callback.call(e.context,t)})})}}),Object.defineProperty(t.prototype,"_dispatchEvent",{enumerable:!1,configurable:!0,writable:!0,value:function(e,t,i){if(!this.interactionsEnabled)return!1;var r=!1;return this._withEvents(e,function(e){h.S6(e.callbacks,function(e){e.disposed||e.object!==t||(e.callback.call(e.context,i),r=!0)})}),r}}),Object.defineProperty(t.prototype,"_dispatchMousedown",{enumerable:!1,configurable:!0,writable:!0,value:function(e){var t=this,i=e.button;if(0==i||2==i||1==i||void 0===i){var r=this.getEvent(e),n=this._getHitTarget(r.point,r.bbox);if(n){var a=r.id,o=!1;w(n,function(e){var i={id:a,value:e};return t._mousedown.push(i),!o&&t._dispatchEvent("pointerdown",e,r)&&(o=!0,t._dragging.some(function(t){return t.value===e&&t.id===a})||t._dragging.push(i)),!0})}}}}),Object.defineProperty(t.prototype,"_dispatchGlobalMousemove",{enumerable:!1,configurable:!0,writable:!0,value:function(e,t){var i=this,r=this.getEvent(e),n=this._getHitTarget(r.point,r.bbox);r.native=t,n?(this._hovering.forEach(function(e){e.contains(n)||(i._hovering.delete(e),e.cursorOverStyle&&c.A_(document.body,"cursor",e._replacedCursorStyle),i._dispatchEvent("pointerout",e,r))}),r.native&&w(n,function(e){return i._hovering.has(e)||(i._hovering.add(e),e.cursorOverStyle&&(e._replacedCursorStyle=c.C2(document.body,"cursor"),c.A_(document.body,"cursor",e.cursorOverStyle)),i._dispatchEvent("pointerover",e,r)),!0})):(this._hovering.forEach(function(e){e.cursorOverStyle&&c.A_(document.body,"cursor",e._replacedCursorStyle),i._dispatchEvent("pointerout",e,r)}),this._hovering.clear()),this._dispatchEventAll("globalpointermove",r)}}),Object.defineProperty(t.prototype,"_dispatchGlobalMouseup",{enumerable:!1,configurable:!0,writable:!0,value:function(e,t){var i=this.getEvent(e);i.native=t,this._dispatchEventAll("globalpointerup",i)}}),Object.defineProperty(t.prototype,"_dispatchDragMove",{enumerable:!1,configurable:!0,writable:!0,value:function(e){var t=this;if(0!==this._dragging.length){var i=this.getEvent(e),r=i.id;this._dragging.forEach(function(e){e.id===r&&t._dispatchEvent("pointermove",e.value,i)})}}}),Object.defineProperty(t.prototype,"_dispatchDragEnd",{enumerable:!1,configurable:!0,writable:!0,value:function(e){var t,i=this,r=e.button;if(0==r||void 0===r)t="click";else if(2==r)t="rightclick";else{if(1!=r)return;t="middleclick"}var n=this.getEvent(e),a=n.id;if(0!==this._mousedown.length){var o=this._getHitTarget(n.point,n.bbox);o&&this._mousedown.forEach(function(e){e.id===a&&e.value.contains(o)&&i._dispatchEvent(t,e.value,n)}),this._mousedown.length=0}0!==this._dragging.length&&(this._dragging.forEach(function(e){e.id===a&&i._dispatchEvent("pointerup",e.value,n)}),this._dragging.length=0)}}),Object.defineProperty(t.prototype,"_dispatchDoubleClick",{enumerable:!1,configurable:!0,writable:!0,value:function(e){var t=this,i=this.getEvent(e),r=this._getHitTarget(i.point,i.bbox);r&&w(r,function(e){return!t._dispatchEvent("dblclick",e,i)})}}),Object.defineProperty(t.prototype,"_dispatchWheel",{enumerable:!1,configurable:!0,writable:!0,value:function(e){var t=this,i=this.getEvent(e),r=this._getHitTarget(i.point,i.bbox);r&&w(r,function(e){return!t._dispatchEvent("wheel",e,i)})}}),Object.defineProperty(t.prototype,"_makeSharedEvent",{enumerable:!1,configurable:!0,writable:!0,value:function(e,t){var i=this;if(void 0===this._listeners[e]){var r=t();this._listeners[e]=new u.DM(function(){delete i._listeners[e],r.dispose()})}return this._listeners[e].increment()}}),Object.defineProperty(t.prototype,"_onPointerEvent",{enumerable:!1,configurable:!0,writable:!0,value:function(e,t){var i=!1,r=null;function n(){r=null,i=!1}return new u.FV([new u.ku(function(){null!==r&&clearTimeout(r),n()}),c.Oo(this.view,c.FL(e),function(e){i=!0,null!==r&&clearTimeout(r),r=window.setTimeout(n,0)}),m(window,e,function(e){null!==r&&(clearTimeout(r),r=null),t(e,i),i=!1})])}}),Object.defineProperty(t.prototype,"_initEvent",{enumerable:!1,configurable:!0,writable:!0,value:function(e){var t=this;switch(e){case"globalpointermove":case"pointerover":case"pointerout":return this._makeSharedEvent("pointermove",function(){var e=function(e,i){t._lastPointerMoveEvent={events:e,native:i},h.S6(e,function(e){t._dispatchGlobalMousemove(e,i)})};return new u.FV([t._onPointerEvent("pointerdown",e),t._onPointerEvent("pointermove",e)])});case"globalpointerup":return this._makeSharedEvent("pointerup",function(){var e=t._onPointerEvent("pointerup",function(e,i){h.S6(e,function(e){t._dispatchGlobalMouseup(e,i)}),t._lastPointerMoveEvent={events:e,native:i}}),i=t._onPointerEvent("pointercancel",function(e,i){h.S6(e,function(e){t._dispatchGlobalMouseup(e,i)}),t._lastPointerMoveEvent={events:e,native:i}});return new u.ku(function(){e.dispose(),i.dispose()})});case"click":case"rightclick":case"middleclick":case"pointerdown":case"pointermove":case"pointerup":return this._makeSharedEvent("pointerdown",function(){var e=m(t.view,"pointerdown",function(e){h.S6(e,function(e){t._dispatchMousedown(e)})}),i=t._onPointerEvent("pointermove",function(e){h.S6(e,function(e){t._dispatchDragMove(e)})}),r=t._onPointerEvent("pointerup",function(e){h.S6(e,function(e){t._dispatchDragEnd(e)})}),n=t._onPointerEvent("pointercancel",function(e){h.S6(e,function(e){t._dispatchDragEnd(e)})});return new u.ku(function(){e.dispose(),i.dispose(),r.dispose(),n.dispose()})});case"dblclick":return this._makeSharedEvent("dblclick",function(){return t._onPointerEvent("dblclick",function(e){h.S6(e,function(e){t._dispatchDoubleClick(e)})})});case"wheel":return this._makeSharedEvent("wheel",function(){return c.Oo(window,c.FL("wheel"),function(e){t._dispatchWheel(e)},{passive:!1})})}}}),Object.defineProperty(t.prototype,"_addEvent",{enumerable:!1,configurable:!0,writable:!0,value:function(e,t,i,r){var n=this,a=this._events[t];void 0===a&&(a=this._events[t]={disposer:this._initEvent(t),callbacks:[],dispatching:!1,cleanup:!1});var o={object:e,context:r,callback:i,disposed:!1};return a.callbacks.push(o),new u.ku(function(){o.disposed=!0,a.dispatching?a.cleanup=!0:(h.Dm(a.callbacks,o),0===a.callbacks.length&&(a.disposer.dispose(),delete n._events[t]))})}}),Object.defineProperty(t.prototype,"getCanvas",{enumerable:!1,configurable:!0,writable:!0,value:function(e,t){var i=this;this.render(e),t||(t={});var r=this.resolution;if(t.minWidth&&t.minWidth>this._width){var n=t.minWidth/this._width;n>r&&(r=n*this.resolution)}if(t.minHeight&&t.minHeight>this._height){var n=t.minHeight/this._height;n>r&&(r=n*this.resolution)}if(t.maxWidth&&t.maxWidth<this._width){var a=t.maxWidth/this._width;a<r&&(r=a*this.resolution)}if(t.maxHeight&&t.maxHeight>this._height){var a=t.maxHeight/this._height;a<r&&(r=a*this.resolution)}t.maintainPixelRatio&&(r/=this.resolution);var o=[],l=!1,u=this._width,s=this._height,c=document.createElement("canvas");r!=this.resolution&&(l=!0,u=this._width*r/this.resolution,s=this._height*r/this.resolution),c.width=u,c.height=s,c.style.position="fixed",c.style.top="-10000px",this.view.appendChild(c),o.push(c);var b=c.getContext("2d"),f=0,d=0,p=!1;return h.S6(this.layers,function(e){e&&e.visible&&(e.tainted||l)&&(p=!0,e.exportableView=e.view,e.exportableContext=e.context,e.view=document.createElement("canvas"),e.view.style.position="fixed",e.view.style.top="-10000px",i.view.appendChild(e.view),o.push(e.view),e.view.width=u,e.view.height=s,e.context=e.view.getContext("2d"),e.dirty=!0,e.scale=r)}),p&&(this._omitTainted=!0,this.render(e),this._omitTainted=!1),h.S6(this.layers,function(e){e&&e.visible&&(b.drawImage(e.view,0,0),e.exportableView&&(e.view=e.exportableView,e.exportableView=void 0),e.exportableContext&&(e.context=e.exportableContext,e.exportableContext=void 0),f<e.view.clientWidth&&(f=e.view.clientWidth),d<e.view.clientHeight&&(d=e.view.clientHeight),e.scale=void 0)}),c.style.width=f+"px",c.style.height=d+"px",h.S6(o,function(e){e.style.position="",e.style.top="",i.view.removeChild(e)}),c}}),t}(u.rk)}}]);